

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>minkit.backends.aop &mdash; minkit 0.0.0.dev0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> minkit
          

          
          </a>

          
            
            
              <div class="version">
                0.0.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference.html">MinKit reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../performance.html">Performance</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">minkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../minkit.html">minkit</a> &raquo;</li>
        
      <li>minkit.backends.aop</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for minkit.backends.aop</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Application interface to deal with arrays. The different array classes</span>
<span class="sd">can not define the __getitem__ since numpy objects would use it to do</span>
<span class="sd">arithmetic operations.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">arrays</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">core</span>
<span class="kn">from</span> <span class="nn">..base</span> <span class="k">import</span> <span class="n">data_types</span>

<span class="kn">import</span> <span class="nn">contextlib</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ArrayOperations&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="ArrayOperations"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations">[docs]</a><span class="k">class</span> <span class="nc">ArrayOperations</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Build the object to do operations within a backend. Only the necessary</span>
<span class="sd">        operators have been defined.</span>

<span class="sd">        :param btype: backend type (&#39;cpu&#39;, &#39;cuda&#39;, &#39;opencl&#39;).</span>
<span class="sd">        :type btype: str</span>
<span class="sd">        :param kwargs: arguments forwarded to the backend constructor \</span>
<span class="sd">        (cuda and opencl backends only).</span>
<span class="sd">        :type kwargs: dict</span>

<span class="sd">        The possible keyword arguments in GPU backends are:</span>

<span class="sd">        * *device*: device to be used.</span>
<span class="sd">        * *interactive*: whether to ask the user a device if not specified or</span>
<span class="sd">          if the proposed device is not available.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__backend</span> <span class="o">=</span> <span class="n">backend</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__backend</span><span class="o">.</span><span class="n">btype</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">CPU</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.cpu</span> <span class="k">import</span> <span class="n">CPUOperations</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span> <span class="o">=</span> <span class="n">CPUOperations</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.gpu</span> <span class="k">import</span> <span class="n">GPUOperations</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span> <span class="o">=</span> <span class="n">GPUOperations</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">backend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Backend interface.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__backend</span>

<div class="viewcode-block" id="ArrayOperations.access_pdf"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.access_pdf">[docs]</a>    <span class="k">def</span> <span class="nf">access_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ndata_pars</span><span class="p">,</span> <span class="n">nvar_arg_pars</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Access the PDF with the given name.</span>

<span class="sd">        :param name: name of the PDF.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param ndata_pars: number of data parameters.</span>
<span class="sd">        :type ndata_pars: int</span>
<span class="sd">        :param nvar_arg_pars: number of variable arguments.</span>
<span class="sd">        :type nvar_arg_pars: int</span>
<span class="sd">        :returns: proxy for the different evaluation functions.</span>
<span class="sd">        :rtype: FunctionsProxy</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">access_pdf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ndata_pars</span><span class="p">,</span> <span class="n">nvar_arg_pars</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.carange"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.carange">[docs]</a>    <span class="k">def</span> <span class="nf">carange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array of elements from 0 to n.</span>

<span class="sd">        :param n: the next to last item in the array.</span>
<span class="sd">        :type n: int</span>
<span class="sd">        :returns: output array.</span>
<span class="sd">        :rtype: carray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">carange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.iarange"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.iarange">[docs]</a>    <span class="k">def</span> <span class="nf">iarange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array of elements from 0 to n.</span>

<span class="sd">        :param n: the next to last item in the array.</span>
<span class="sd">        :type n: int</span>
<span class="sd">        :returns: output array.</span>
<span class="sd">        :rtype: iarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">iarange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.ndarray_to_backend"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.ndarray_to_backend">[docs]</a>    <span class="k">def</span> <span class="nf">ndarray_to_backend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array in the backend of this object. This will directly</span>
<span class="sd">        create an object of the underlying array type of the :class:`minkit.barray`,</span>
<span class="sd">        :class:`minkit.farray` or :class:`minkit.iarray` instance.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: numpy.ndarray</span>
<span class="sd">        :returns: array representation in the given backend.</span>
<span class="sd">        :rtype: numpy.ndarray or reikna.cluda.api.Array</span>

<span class="sd">        .. warning:: This function must be used carefully since the output array \</span>
<span class="sd">           does not track to which backend it belongs.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">ndarray_to_backend</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.concatenate"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.concatenate">[docs]</a>    <span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arrays</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Concatenate several arrays. If &quot;maximum&quot; is specified, the last elements</span>
<span class="sd">        will be dropped, so the length of the output array is &quot;maximum&quot;.</span>

<span class="sd">        :param arrays: collection of arrays.</span>
<span class="sd">        :type arrays: tuple(farray)</span>
<span class="sd">        :param maximum: possible maximum length of the output array.</span>
<span class="sd">        :type maximum: int</span>
<span class="sd">        :returns: concatenated array.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">),</span> <span class="n">maximum</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.count_nonzero"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.count_nonzero">[docs]</a>    <span class="k">def</span> <span class="nf">count_nonzero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Count the number of elements that are different from zero.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: barray</span>
<span class="sd">        :returns: number of elements that are different from zero.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.bempty"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.bempty">[docs]</a>    <span class="k">def</span> <span class="nf">bempty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an empty :class:`barray` instance with the given length.</span>

<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: empty array.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">bempty</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.fempty"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.fempty">[docs]</a>    <span class="k">def</span> <span class="nf">fempty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an empty :class:`darray` instance with the given length.</span>

<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: empty array.</span>
<span class="sd">        :rtype: darray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">fempty</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.iempty"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.iempty">[docs]</a>    <span class="k">def</span> <span class="nf">iempty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an empty :class:`iarray` instance with the given length.</span>

<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: empty array.</span>
<span class="sd">        :rtype: iarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">iempty</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.cexp"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.cexp">[docs]</a>    <span class="k">def</span> <span class="nf">cexp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate the exponential of an array of numbers.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: carray</span>
<span class="sd">        :returns: exponential values.</span>
<span class="sd">        :rtype: carray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">cexp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.fexp"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.fexp">[docs]</a>    <span class="k">def</span> <span class="nf">fexp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate the exponential of an array of numbers. The input array must</span>
<span class="sd">        be unidimensional.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: darray</span>
<span class="sd">        :returns: exponential values.</span>
<span class="sd">        :rtype: darray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">fexp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.fftconvolve"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.fftconvolve">[docs]</a>    <span class="k">def</span> <span class="nf">fftconvolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate the convolution of two arrays that correspond to the output</span>
<span class="sd">        from the evaluation of two PDFs in the given data.</span>

<span class="sd">        :param a: first array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param b: second array.</span>
<span class="sd">        :type b: farray</span>
<span class="sd">        :param data: array of data (only 1D is supported).</span>
<span class="sd">        :type data: farray</span>
<span class="sd">        :returns: convolution of the two arrays.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.ge"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.ge">[docs]</a>    <span class="k">def</span> <span class="nf">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compare two arrays :math:`a \geq b`. The input arrays must be unidimensional.</span>

<span class="sd">        :param a: first array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param b: second array.</span>
<span class="sd">        :type b: farray</span>
<span class="sd">        :returns: result of the comparison.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.make_linear_interpolator"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.make_linear_interpolator">[docs]</a>    <span class="k">def</span> <span class="nf">make_linear_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create a function that, given an array of points in *x*, provides the</span>
<span class="sd">        interpolated values using a linear interpolator.</span>

<span class="sd">        :param xp: reference points in the x axis.</span>
<span class="sd">        :type xp: darray</span>
<span class="sd">        :param yp: reference points in the y axis.</span>
<span class="sd">        :type yp: darray</span>
<span class="sd">        :returns: interpolator.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">make_linear_interpolator</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.make_spline_interpolator"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.make_spline_interpolator">[docs]</a>    <span class="k">def</span> <span class="nf">make_spline_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create a function that, given an array of points in *x*, provides the</span>
<span class="sd">        interpolated values using an spline of order 3.</span>

<span class="sd">        :param xp: reference points in the x axis.</span>
<span class="sd">        :type xp: darray</span>
<span class="sd">        :param yp: reference points in the y axis.</span>
<span class="sd">        :type yp: darray</span>
<span class="sd">        :returns: interpolator.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">make_spline_interpolator</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.product_by_zero_is_zero"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.product_by_zero_is_zero">[docs]</a>    <span class="k">def</span> <span class="nf">product_by_zero_is_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Do a product of two arrays in such a way that if any of the elements</span>
<span class="sd">        is zero the output will be zero.</span>

<span class="sd">        :param f: first array.</span>
<span class="sd">        :type f: darray</span>
<span class="sd">        :param s: second array.</span>
<span class="sd">        :type f: darray</span>
<span class="sd">        :returns: Product of the two arrays.</span>
<span class="sd">        :rtype: darray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">product_by_zero_is_zero</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bool_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Data type used for boolean comparisons.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">core</span><span class="o">.</span><span class="n">is_gpu_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__backend</span><span class="o">.</span><span class="n">btype</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">data_types</span><span class="o">.</span><span class="n">cpu_bool</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">data_types</span><span class="o">.</span><span class="n">cpu_real_bool</span>

<div class="viewcode-block" id="ArrayOperations.is_bool"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.is_bool">[docs]</a>    <span class="k">def</span> <span class="nf">is_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Check whether the data type of the given array is of boolean type.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: marray, numpy.ndarray or reikna.cluda.api.Array</span>
<span class="sd">        :returns: decision.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bool_type</span></div>

<div class="viewcode-block" id="ArrayOperations.is_complex"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.is_complex">[docs]</a>    <span class="k">def</span> <span class="nf">is_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Check whether the data type of the given array is of complex type.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: marray, numpy.ndarray or reikna.cluda.api.Array</span>
<span class="sd">        :returns: decision.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">data_types</span><span class="o">.</span><span class="n">cpu_complex</span></div>

<div class="viewcode-block" id="ArrayOperations.is_float"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.is_float">[docs]</a>    <span class="k">def</span> <span class="nf">is_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Check whether the data type of the given array is of floating point type.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: marray, numpy.ndarray or reikna.cluda.api.Array</span>
<span class="sd">        :returns: decision.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">data_types</span><span class="o">.</span><span class="n">cpu_float</span></div>

<div class="viewcode-block" id="ArrayOperations.is_int"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.is_int">[docs]</a>    <span class="k">def</span> <span class="nf">is_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Check whether the data type of the given array is of integral type.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: marray, numpy.ndarray or reikna.cluda.api.Array</span>
<span class="sd">        :returns: decision.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">data_types</span><span class="o">.</span><span class="n">cpu_int</span></div>

<div class="viewcode-block" id="ArrayOperations.is_inside"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.is_inside">[docs]</a>    <span class="k">def</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the decision whether the input data is within the given bounds</span>
<span class="sd">        or not.</span>

<span class="sd">        :param data: input data array.</span>
<span class="sd">        :type data: farray</span>
<span class="sd">        :param lb: lower bounds.</span>
<span class="sd">        :type lb: numpy.ndarray</span>
<span class="sd">        :param ub: upper bounds.</span>
<span class="sd">        :type ub: numpy.ndarray</span>
<span class="sd">        :returns: array with the decisions.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.le"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.le">[docs]</a>    <span class="k">def</span> <span class="nf">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compare two arrays :math:`a \leq b`. The input arrays must be unidimensional.</span>

<span class="sd">        :param a: first array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param b: second array.</span>
<span class="sd">        :type b: farray</span>
<span class="sd">        :returns: result of the comparison.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.lt"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.lt">[docs]</a>    <span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compare two arrays :math:`a &lt; b`. The input arrays must be unidimensional.</span>

<span class="sd">        :param a: first array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param b: second array.</span>
<span class="sd">        :type b: farray</span>
<span class="sd">        :returns: result of the comparison.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.linspace"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.linspace">[docs]</a>    <span class="k">def</span> <span class="nf">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array where the values are in increasing order by a constant</span>
<span class="sd">        step. Points in &quot;vmin&quot; and &quot;vmax&quot; are included.</span>

<span class="sd">        :param vmin: where to start generating values.</span>
<span class="sd">        :type vmin: float</span>
<span class="sd">        :param vmax: where to end generating values.</span>
<span class="sd">        :type vmax: float</span>
<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: array.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.log"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.log">[docs]</a>    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate the logarithm of an array of numbers. The input array must</span>
<span class="sd">        be unidimensional.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :returns: logarithm values.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.logical_and"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.logical_and">[docs]</a>    <span class="k">def</span> <span class="nf">logical_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Do the logical &quot;and&quot; operation element by element.</span>

<span class="sd">        :param a: first array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param b: second array.</span>
<span class="sd">        :type b: farray</span>
<span class="sd">        :param out: possible output array to write the data.</span>
<span class="sd">        :type out: barray</span>
<span class="sd">        :returns: array of decisions.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arrays</span><span class="o">.</span><span class="n">barray</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.logical_or"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.logical_or">[docs]</a>    <span class="k">def</span> <span class="nf">logical_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Do the logical &quot;or&quot; operation element by element.</span>

<span class="sd">        :param a: first array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param b: second array.</span>
<span class="sd">        :type b: farray</span>
<span class="sd">        :param out: possible output array to write the data.</span>
<span class="sd">        :type out: barray</span>
<span class="sd">        :returns: array of decisions.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arrays</span><span class="o">.</span><span class="n">barray</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.max"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.max">[docs]</a>    <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate the maximum value in an array.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :returns: maximum value.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.meshgrid"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.meshgrid">[docs]</a>    <span class="k">def</span> <span class="nf">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create a grid of values using the given set of bounds. The size can</span>
<span class="sd">        be specified as a single value or as a set of sizes for each dimension.</span>
<span class="sd">        If it is a single value, then the output array will be of length</span>
<span class="sd">        :math:`size \times size \times ...`, depending on the number of dimensions.</span>

<span class="sd">        :param lb: lower bounds.</span>
<span class="sd">        :type lb: numpy.ndarray</span>
<span class="sd">        :param ub: upper bounds.</span>
<span class="sd">        :type ub: numpy.ndarray</span>
<span class="sd">        :param size: size of the grid to generate.</span>
<span class="sd">        :type size: numpy.ndarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.min"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.min">[docs]</a>    <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate the minimum value in an array.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :returns: minimum value.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.bones"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.bones">[docs]</a>    <span class="k">def</span> <span class="nf">bones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array of &quot;true&quot; values of the given size.</span>

<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: array of &quot;true&quot;.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">bones</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.bzeros"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.bzeros">[docs]</a>    <span class="k">def</span> <span class="nf">bzeros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array of &quot;false&quot; values of the given size.</span>

<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: array of &quot;false&quot;.</span>
<span class="sd">        :rtype: barray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">bzeros</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.fones"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.fones">[docs]</a>    <span class="k">def</span> <span class="nf">fones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array of the given size filled with ones.</span>

<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: array of ones.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">fones</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.fzeros"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.fzeros">[docs]</a>    <span class="k">def</span> <span class="nf">fzeros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create an array of the given size filled with zeros.</span>

<span class="sd">        :param size: length of the output array.</span>
<span class="sd">        :type size: int</span>
<span class="sd">        :returns: array of zeros.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">fzeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.random_grid"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.random_grid">[docs]</a>    <span class="k">def</span> <span class="nf">random_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create a random grid using the given bounds. The size can be specified</span>
<span class="sd">        as a single value or as a set of sizes for each dimension. If it is a</span>
<span class="sd">        single value, then the output array will be of length</span>
<span class="sd">        :math:`size \times size \times ...`, depending on the number of dimensions.</span>

<span class="sd">        :param lb: lower bounds.</span>
<span class="sd">        :type lb: numpy.ndarray</span>
<span class="sd">        :param ub: upper bounds.</span>
<span class="sd">        :type ub: numpy.ndarray</span>
<span class="sd">        :param size: size of the grid.</span>
<span class="sd">        :type size: int or numpy.ndarray</span>
<span class="sd">        :returns: random grid.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">random_grid</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.random_uniform"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.random_uniform">[docs]</a>    <span class="k">def</span> <span class="nf">random_uniform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.restrict_data_size"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.restrict_data_size">[docs]</a>    <span class="k">def</span> <span class="nf">restrict_data_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Drop the last elements of an array of data.</span>

<span class="sd">        :param maximum: maximum length of the data sample.</span>
<span class="sd">        :type maximum: int</span>
<span class="sd">        :param data: data sample.</span>
<span class="sd">        :type data: farray</span>
<span class="sd">        :returns: reduced data array.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">restrict_data_size</span><span class="p">(</span><span class="n">maximum</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.set_rndm_seed"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.set_rndm_seed">[docs]</a>    <span class="k">def</span> <span class="nf">set_rndm_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set the seed of the random number generator.</span>

<span class="sd">        :param seed: new seed to use.</span>
<span class="sd">        :type seed: int</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">set_rndm_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.shuffling_index"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.shuffling_index">[docs]</a>    <span class="k">def</span> <span class="nf">shuffling_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculate a set of indices to shuffle an array.</span>

<span class="sd">        :param n: length of the array.</span>
<span class="sd">        :type n: int</span>
<span class="sd">        :returns: array of indices.</span>
<span class="sd">        :rtype: iarray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">shuffling_index</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.sum"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.sum">[docs]</a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sum the elements of the given array.</span>

<span class="sd">        :param a: input array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :returns: sum of elements.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.sum_arrays"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.sum_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">sum_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arrays</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sum arrays element by element.</span>

<span class="sd">        :param arrays: set of arrays.</span>
<span class="sd">        :type arrays: tuple(farray)</span>
<span class="sd">        :returns: array with the sum.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fzeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="ArrayOperations.sum_inside"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.sum_inside">[docs]</a>    <span class="k">def</span> <span class="nf">sum_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">gaps</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sum the occurrences inside the given bounds. If &quot;values&quot; is specified,</span>
<span class="sd">        then the values in it are used instead.</span>

<span class="sd">        :param indices: array of indices.</span>
<span class="sd">        :type indices: numpy.ndarray</span>
<span class="sd">        :param gaps: gaps to access the data.</span>
<span class="sd">        :type gaps: numpy.ndarray</span>
<span class="sd">        :param centers: centers corresponding to a data sample.</span>
<span class="sd">        :type centers: farray</span>
<span class="sd">        :param edges: edges defining the bins.</span>
<span class="sd">        :type edges: farray</span>
<span class="sd">        :param values: possible values (or weights) associated to the data sample.</span>
<span class="sd">        :type values: farray or None</span>
<span class="sd">        :returns: sum inside each bin.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">sum_inside</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">gaps</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.slice_from_boolean"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.slice_from_boolean">[docs]</a>    <span class="k">def</span> <span class="nf">slice_from_boolean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get a slice of the given array using a mask array.</span>

<span class="sd">        :param a: input data array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param v: mask array.</span>
<span class="sd">        :type v: barray</span>
<span class="sd">        :returns: slice of the array.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">slice_from_boolean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.slice_from_integer"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.slice_from_integer">[docs]</a>    <span class="k">def</span> <span class="nf">slice_from_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get a slice of the given array using an array of indices.</span>

<span class="sd">        :param a: input data array.</span>
<span class="sd">        :type a: farray</span>
<span class="sd">        :param i: array of indices.</span>
<span class="sd">        :type i: iarray</span>
<span class="sd">        :returns: slice of the array.</span>
<span class="sd">        :rtype: farray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">slice_from_integer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.take_column"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.take_column">[docs]</a>    <span class="k">def</span> <span class="nf">take_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Take elements of the array using a period.</span>

<span class="sd">        :param i: column to take the elements.</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :returns: reduced array.</span>
<span class="sd">        :rtype: marray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">take_column</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.take_slice"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.take_slice">[docs]</a>    <span class="k">def</span> <span class="nf">take_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Take a slice of entries from the array.</span>

<span class="sd">        :param start: where to start taking entries.</span>
<span class="sd">        :type start: int</span>
<span class="sd">        :param end: where to end taking entries.</span>
<span class="sd">        :type end: int</span>
<span class="sd">        :returns: slice of the array.</span>
<span class="sd">        :rtype: marray</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">end</span> <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">take_slice</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></div>

<div class="viewcode-block" id="ArrayOperations.using_caches"><a class="viewcode-back" href="../../../api/minkit.ArrayOperations.html#minkit.ArrayOperations.using_caches">[docs]</a>    <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
    <span class="k">def</span> <span class="nf">using_caches</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Use the caches (GPU only). Only those caches related to arrays and functions</span>
<span class="sd">        (not the PDFs) will be removed.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">core</span><span class="o">.</span><span class="n">is_gpu_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__backend</span><span class="o">.</span><span class="n">btype</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__oper</span><span class="o">.</span><span class="n">using_caches</span><span class="p">():</span>
                <span class="k">yield</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Miguel Ramos Pernas

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>